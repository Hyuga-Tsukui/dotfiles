# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§ª [ENVIRONMENT]
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.nix-profile/bin:$PATH" # use nix profile

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§ª [FUNCTIONS]
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

_compinit() {
   local re_initialize=0
   for match in ${ZDOTDIR}/.zcompdump*(.Nmh+24); do
     re_initialize=1
     break
   done
   
   autoload -Uz compinit
   if [ "$re_initialize" -eq "1" ]; then
     compinit
     # update the timestamp on compdump file
     compdump
   else
     # omit the check for new functions since we updated today
     compinit -C
   fi
 }
 _compinit

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ’» [ALIASES]
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
alias vim="nvim"
alias vi="nvim"
alias ls="eza"


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§© [ZINIT SETUP]
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
bindkey -e
ZINIT_HOME="${XDG_DATA_HOME:-${HOME}/.local/share}/zinit/zinit.git"
[ ! -d $ZINIT_HOME ] && mkdir -p "$(dirname $ZINIT_HOME)"
[ ! -d $ZINIT_HOME/.git ] && git clone https://github.com/zdharma-continuum/zinit.git "$ZINIT_HOME"
source "${ZINIT_HOME}/zinit.zsh"

alias zinit-update="zinit self-update && zinit update --all"

# REF: https://github.com/zdharma-continuum/zinit/discussions/312 zoxside(zi) And zinit(zi) in conflict. 
if alias zi &>/dev/null; then
    unalias zi
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŒŸ [ZSH PLUGINS]
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# pure prompt
zinit ice compile'(pure|async).zsh' pick'async.zsh' src'pure.zsh'
zinit light sindresorhus/pure
zstyle :prompt:pure:path color green

# zeno
export ZENO_HOME=~/.config/zeno
zinit ice lucid depth"1" blockf
zinit light yuki-yano/zeno.zsh

if [[ -n $ZENO_LOADED ]]; then
  bindkey ' ' zeno-auto-snippet
  bindkey '^m' zeno-auto-snippet-and-accept-line
  bindkey '^i' zeno-completion
  bindkey '^gq' zeno-ghq-cd
  bindkey '^r' zeno-history-selection
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ’» [ZSH]
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
setopt nolistbeep # ãƒ“ãƒ¼ãƒ—éŸ³ã‚’é³´ã‚‰ã•ãªã„
setopt auto_menu # è£œå®Œã‚­ãƒ¼ï¼ˆTab,  Ctrl+I) ã‚’é€£æ‰“ã™ã‚‹ã ã‘ã§é †ã«è£œå®Œå€™è£œã‚’è‡ªå‹•ã§è£œå®Œã™ã‚‹
setopt auto_param_slash # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å±•é–‹æ™‚ã«æœ«å°¾ã®ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’è‡ªå‹•ã§è£œå®Œã™ã‚‹
zstyle ':completion:*' list-colors di=34 fi=0 # è£œå®Œå€™è£œã®è‰²ã‚’è¨­å®š
setopt HIST_NO_STORE # `history`ã‚³ãƒãƒ³ãƒ‰ã¯å±¥æ­´ã«ç™»éŒ²ã—ãªã„
setopt HIST_SAVE_NO_DUPS # å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãŸã¨ãˆã° ~/.zsh_historyï¼‰ã«åŒã˜å†…å®¹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’é‡è¤‡ã—ã¦ä¿å­˜ã—ãªã„ 
setopt HIST_IGNORE_ALL_DUPS # ã‚³ãƒãƒ³ãƒ‰å±¥æ­´ã«è¿½åŠ ã™ã‚‹å‰ã«ã€ã™ã§ã«å­˜åœ¨ã™ã‚‹åŒã˜ã‚³ãƒãƒ³ãƒ‰ãŒã‚ã‚Œã°å‰Šé™¤ã—ã¦ã‹ã‚‰è¿½åŠ ã™ã‚‹
setopt HIST_IGNORE_SPACE # å…ˆé ­ã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä»˜ã‘ã¦å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰ã¯å±¥æ­´ã«æ®‹ã•ãªã„
setopt HIST_REDUCE_BLANKS # è¤‡æ•°ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’1ã¤ã«åœ§ç¸®ã—ã¦å±¥æ­´ã«ä¿å­˜ã™ã‚‹
setopt SHARE_HISTORY # è¤‡æ•°ã® Zsh ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆãŸã¨ãˆã°è¤‡æ•°ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰é–“ã§å±¥æ­´ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«å…±æœ‰ã™ã‚‹
setopt APPEND_HISTORY # ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã€å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã›ãšæœ«å°¾ã«è¿½åŠ ã™ã‚‹

autoload -Uz edit-command-line
zle -N edit-command-line
bindkey "^O" edit-command-line

# ã‚³ãƒãƒ³ãƒ‰ã®è£œå®Œãƒªã‚¹ãƒˆã®èª­ã¿è¾¼ã¿
fpath=($HOME/.nix-profile/share/zsh/site-functions $fpath)

export FZF_DEFAULT_OPTS='--height 40% --reverse --border --inline-info'

# Setting fd as the default source for fzf
export FZF_DEFAULT_COMMAND='fd --type f --strip-cwd-prefix'
export FZF_CTRL_T_OPTS="
  --walker-skip .git,node_modules,target
  --preview 'bat -n --color=always {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"
# To apply the command to CTRL-T as well
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"

# Add PATH My Scripts
export PATH="$HOME/bin:$PATH"

# https://volta.sh/
export VOLTA_HOME="$HOME/.volta"
export PATH="$VOLTA_HOME/bin:$PATH"


# https://git-scm.com/book/ms/v2/Appendix-A%3A-Git-in-Other-Environments-Git-in-Zsh
autoload bashcompinit && bashcompinit

# https://github.com/zsh-users/zsh-autosuggestions/blob/master/INSTALL.md
source "$HOME/.nix-profile/share/zsh-autosuggestions/zsh-autosuggestions.zsh"

export PATH="$HOME/go/bin:$PATH"

bindkey -r "^G"
bindkey -r "^J"
bindkey "^[u" undo
bindkey "^[x" redo
bindkey "^[l" clear-screen

eval "$(zoxide init zsh --hook prompt )"
eval "$(uv generate-shell-completion zsh)"
eval "$(mise activate zsh)"

LOCAL_ZSH="${HOME}/.zsh/local.zsh"
if [[ -f "${LOCAL_ZSH}" ]]; then
  source "${LOCAL_ZSH}"
fi
